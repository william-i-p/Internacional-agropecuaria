jQuery(document).ready((function(){elementor.hooks.addAction("panel/open_editor/widget",(function(e,t,o){var n=t.attributes.widgetType;"ae-acf-repeater"==n&&jQuery(document).on("change","select[data-setting='layout_mode']",(function(){elementor.reloadPreview()})),"ae-acf"==n&&jQuery(".elementor-control-_skin label").html("Field Type"),"ae-pods"==n&&jQuery(".elementor-control-_skin label").html("Field Type"),"ae-post-blocks-adv"==n&&jQuery(".elementor-control-_skin label").html("Layout"),"ae-post-blocks"==n&&(jQuery(document).on("change","select[data-setting='layout_mode']",(function(){})),selected_post_ids=t.attributes.settings.attributes.ae_post_ids,jQuery.ajax({url:aepro.ajaxurl,dataType:"json",method:"post",data:{selected_posts:selected_post_ids,action:"ae_post_data",fetch_mode:"selected_posts"},success:function(e){options="",e.data.length&&jQuery.each(e.data,(function(e,t){options+='<option selected value="'+t.id+'">'+t.text+"</option>"})),jQuery("select[data-setting='ae_post_ids']").html(options).select2({ajax:{url:aepro.ajaxurl,dataType:"json",data:function(e){return{q:e.term,action:"ae_post_data",fetch_mode:"posts"}},processResults:function(e){return{results:e.data}}},minimumInputLength:2})}}))}))})),function(e,t,o){var n=e.modules.controls.Select2.extend({cache:null,isTitlesReceived:!1,getSelect2Placeholder:function(){return{id:"",text:this.model.get("placeholder")||"All"}},getSelect2DefaultOptions:function(){var t=this;return void 0!==t.model.get("parent_field")?parent_field=t.model.get("parent_field"):parent_field="flexible_field",jQuery.extend(e.modules.controls.Select2.prototype.getSelect2DefaultOptions.apply(this,arguments),{ajax:{transport:function(e,o,n){var a={q:e.data.q,query_type:t.model.get("query_type"),query_options:t.model.get("query_options"),object_type:t.model.get("object_type")};return"flex-sub-fields"===t.model.get("query_type")&&(void 0!==t.model.get("parent_field")?parent_field=t.model.get("parent_field"):parent_field="flexible_field",a.flex_parent_field=t.options.elementSettingsModel.attributes[parent_field]),elementorCommon.ajax.addRequest("aep_query_autocomplete_data",{data:a,success:o,error:n})},data:function(e){return{q:e.term,page:e.page}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1})},getValueTitles:function(){var e=this,t=this.getControlValue(),o=this.model.get("query_type"),n=this.model.get("query_options"),a=this.model.get("object_type");if(t&&o){if(_.isArray(t)||(t=[t]),"flex-sub-fields"===o)var i=e.options.elementSettingsModel.attributes[parent_field];elementorCommon.ajax.loadObjects({action:"aep_query_value_titles",ids:t,data:{query_type:o,query_options:n,object_type:a,unique_id:""+e.cid+o,flex_parent_field:i},success:function(t){e.isTitlesReceived=!0,e.model.set("options",t),e.render()},before:function(){e.addSpinner()}})}},addSpinner:function(){this.ui.select.prop("disabled",!0),this.$el.find(".elementor-control-title").after('<span class="elementor-control-spinner pp-control-spinner">&nbsp;<i class="fa fa-spinner fa-spin"></i>&nbsp;</span>')},onReady:function(){setTimeout(e.modules.controls.Select2.prototype.onReady.bind(this)),this.isTitlesReceived||this.getValueTitles()},onBeforeDestroy:function(){this.ui.select.data("select2")&&this.ui.select.select2("destroy"),this.$el.remove()}});e.addControlView("aep-query",n)}(elementor,jQuery,window);